'use client';

/**
 * @file {{PascalFeatureName}} list component
 * @module components/dashboard/{{featureNamePlural}}/{{PascalFeatureName}}List
 */

import React from 'react';
import {
  Box,
  Paper,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow,
  TablePagination,
  IconButton,
  Typography,
  Chip,
  Tooltip,
} from '@mui/material';
import {
  Edit as EditIcon,
  Delete as DeleteIcon,
  Visibility as ViewIcon,
} from '@mui/icons-material';

/**
 * {{PascalFeatureName}} list component
 * Displays a table of {{featureNamePlural}} with actions
 * 
 * @component
 * @param {Object} props - Component props
 * @param {Array} props.{{featureNamePlural}} - Array of {{featureName}} objects
 * @param {Function} props.onItemClick - Handler for when an item is clicked
 * @param {Function} props.onDeleteItem - Handler for when delete is clicked
 * @param {Object} props.pagination - Pagination info
 * @param {number} props.pagination.page - Current page
 * @param {number} props.pagination.limit - Items per page
 * @param {number} props.pagination.total - Total items
 * @param {Function} props.onPageChange - Handler for page change
 * @param {Function} props.onLimitChange - Handler for page size change
 * @returns {React.ReactElement} {{PascalFeatureName}}List component
 */
export default function {{PascalFeatureName}}List({
  {{featureNamePlural}} = [],
  onItemClick,
  onDeleteItem,
  pagination = { page: 0, limit: 10, total: 0 },
  onPageChange,
  onLimitChange
}) {
  const formatDate = (dateString) => {
    if (!dateString) return 'N/A';
    const date = new Date(dateString);
    return date.toLocaleDateString();
  };

  const handlePageChange = (event, newPage) => {
    if (onPageChange) {
      onPageChange(newPage + 1);
    }
  };

  const handleLimitChange = (event) => {
    if (onLimitChange) {
      onLimitChange(parseInt(event.target.value, 10));
    }
  };

  if ({{featureNamePlural}}.length === 0) {
    return (
      <Paper sx=\{\{ p: 3, textAlign: 'center' \}\}>
        <Typography variant="body1">
          No {{featureNamePlural}} found.
        </Typography>
      </Paper>
    );
  }

  const muiPagination = {
    page: (pagination.page || 1) - 1,
    rowsPerPage: pagination.limit || 10,
    count: pagination.total || 0
  };

  return (
    <Paper sx=\{\{ width: '100%', overflow: 'hidden' \}\}>
      <TableContainer>
        <Table>
          <TableHead>
            <TableRow>
              <TableCell>Name</TableCell>
              <TableCell>Description</TableCell>
              <TableCell>Created</TableCell>
              <TableCell align="right">Actions</TableCell>
            </TableRow>
          </TableHead>
          <TableBody>
            { {{featureNamePlural}}.map(({{featureName}}) => (
              <TableRow
                key=\{ {{featureName}}._id \}
                hover
                onClick=\{() => onItemClick && onItemClick({{featureName}}._id)\}
                sx=\{ \{ cursor: 'pointer' \} \}
              >
                <TableCell component="th" scope="row">
                  {{featureName}}.name
                </TableCell>
                <TableCell>
                  {{featureName}}.description || 'No description'
                </TableCell>
                <TableCell>
                  {formatDate({{featureName}}.createdAt)}
                </TableCell>
                <TableCell align="right">
                  <Box sx=\{\{ display: 'flex', justifyContent: 'flex-end' \}\}>
                    <Tooltip title="View/Edit">
                      <IconButton
                        size="small"
                        onClick={(e) => {
                          e.stopPropagation();
                          onItemClick && onItemClick({{featureName}}._id);
                        }}
                      >
                        <EditIcon fontSize="small" />
                      </IconButton>
                    </Tooltip>
                    {{#if includeDelete}}
                    <Tooltip title="Delete">
                      <IconButton
                        size="small"
                        color="error"
                        onClick={(e) => {
                          e.stopPropagation();
                          onDeleteItem && onDeleteItem({{featureName}}._id);
                        }}
                      >
                        <DeleteIcon fontSize="small" />
                      </IconButton>
                    </Tooltip>
                    {{/if}}
                  </Box>
                </TableCell>
              </TableRow>
            )) }
          </TableBody>
        </Table>
      </TableContainer>

      <TablePagination
        component="div"
        count={muiPagination.count}
        page={muiPagination.page}
        rowsPerPage={muiPagination.rowsPerPage}
        onPageChange={handlePageChange}
        onRowsPerPageChange={handleLimitChange}
        rowsPerPageOptions={[5, 10, 25, 50, 100]}
      />
    </Paper>
  );
}
